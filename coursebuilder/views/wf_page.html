{% extends 'base.html' %}
{% block top_content %}
{% include "notifications_area.html" %}
{% endblock %}
{% block main_content %}
{% if editor_role and can_do_assignments %}
<a href="{{action_url('edit')}}">edit</a> as {{ editor_role }}
{% endif %}
<div class="gcb-aux">
  <div class="gcb-cols">
    <div class="gcb-col-11 gcb-aside">
      {% if unit %}
      <h1>Unit {{ unit.unit_id }} - {{ unit.title | safe }} <small class="wiki-unit-link">
          <a href="unit?unit={{ unit.unit_id }}">(prompt)</a></small></h1>
      {% endif %}
      <div>by {{ author_link(author) }}</div>
      {{ content | safe }}
    </div>
  </div>
  <div class="gcb-cols">
    <div id="assignment-completion" class="gcb-col-11 gcb-aside">
      <div id="endorsements" class="gcb-col-5">
        {% for e in endorsements %}
        {% if loop.first %}This page has been endorsed as complete by{% endif %}
        {% if loop.last and not loop.first %} and {% endif %}
        <a href="wikiprofile?student={{ e.who.wiki_id }}">{{ e.who.name }}</a>{% if not loop.last%},{%endif%}
        {% else %}
        <b>This page has not yet been marked as complete.</b>
        {% endfor %}
        <br>
        {% if endorsement_view == 'has_endorsed' %}
        You have marked this page as complete.
        {% elif endorsement_view == 'can_endorse' %}
        <form action="{{ action_url('endorse') }}" method="POST">
          <input type="hidden" name="xsrf_token" value="{{ create_xsrf_token('endorse') }}">
          Click here to endorse that the author has completed
          <input type="submit" name="required_done" class="gcb-button" value="the required parts">, or
          <input type="submit" name="all_done" class="gcb-button" value="the required AND optional parts"> of the assignment.
        </form>
        {% endif %}
      </div>
      <div id="exemplaries" class="gcb-col-5">
        {% for e in exemplaries %}
        {% if loop.first %}<span style="float:left; font-size: 2em; color: #fc0;">&#9733;</span> This page has been marked as exemplary by{% endif %}
        {% if loop.last and not loop.first %} and {% endif %}
        <a href="wikiprofile?student={{ e.who.wiki_id }}">{{ e.who.name }}</a>{% if not loop.last%},{%endif%}
        {% if loop.last %}<br>{% endif %}
        {% else %}<!-- no exemplaries -->
        {% endfor %}
        {% if exemplary_view == 'can_exemplary' %}
        You can mark this page as exemplary!<br>
        <form action="{{ action_url('exemplary') }}" method="POST">
          <input type="hidden" name="xsrf_token" value="{{ create_xsrf_token('exemplary') }}">
          <textarea name="comment" style="width: 100%" rows="2" placeholder="This is great because..."></textarea><br>
          <input type="submit" class="gcb-button" value="Exemplary">
        </form>
        {% elif exemplary_view == 'has_exemplaried' %}
        You have marked this page as exemplary.
        {% endif %}
      </div>
    </div>

  </div>
  {% include "comment_area.html" %}
  <center><a onclick="$(this).next().toggle()" style="color: #c33;">Flag inappropriate content</a>
    <div id="flag-form" style="display: none;">
      <form action="{{ action_url('flag') }}" method="POST">
        <input type="hidden" name="xsrf_token" value="{{ create_xsrf_token('flag') }}">
        You can alert an instructor regarding inappropriate content on this page:<br>
        <input size="60" name="reason"></input>
        <input type="submit" value="Report">
      </form>
    </div>
  </center>
</div>
<script src="/assets/lib/Placeholders.min.js"></script>
{% endblock %}
